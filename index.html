<!DOCTYPE html>
<html lang="bg">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="refresh" content="3600" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
      crossorigin="anonymous"
    />
    <link href="style.css" rel="stylesheet" />
    <title>Верди</title>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row" style="margin: 0">
        <div class="col-6" style="padding: 0">
          <table class="table table-dark align-middle">
            <thead class="thead-dark">
              <tr>
                <th scope="col" class="col-9" id="size"></th>
                <th scope="col" class="col-1" style="background-color: #d20c16">
                  25см
                </th>
                <th scope="col" class="col-1" style="background-color: #d20c16">
                  30см
                </th>
                <th scope="col" class="col-1" style="background-color: #d20c16">
                  36см
                </th>
              </tr>
            </thead>
            <tbody id="pizzas_left"></tbody>
          </table>
        </div>
        <div class="col-6" style="padding: 0">
          <table class="table table-dark align-middle">
            <thead class="thead-dark">
              <tr>
                <th scope="col" class="col-9"></th>
                <th scope="col" class="col-1" style="background-color: #d20c16">
                  25см
                </th>
                <th scope="col" class="col-1" style="background-color: #d20c16">
                  30см
                </th>
                <th scope="col" class="col-1" style="background-color: #d20c16">
                  36см
                </th>
              </tr>
            </thead>
            <tbody id="pizzas_right"></tbody>
          </table>
        </div>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
      crossorigin="anonymous"
    ></script>
    <script src="fn.js"></script>
    <script>
      let table_left = document.getElementById("pizzas_left");
      let table_right = document.getElementById("pizzas_right");
      fetch("pizza.csv")
        .then((response) => {
          if (!response.ok) throw new Error(`Грешка: ${response.status}`);
          return response.text();
        })
        .then(csvToArray)
        .then((l) => {
          const rs = [];
          l.forEach((p) => {
            if (!isRowValid(p)) {
              return;
            }
            if (
              p.display.toLowerCase() !== "all" &&
              getDisplayParam() !== "all" &&
              getDisplayParam() !== p.display
            ) {
              return;
            }
            rs.push(p);
          });
          const half = Math.ceil(rs.length / 2);
          let left = rs.slice(0, half);
          let leftIndex = 0;
          let right = rs.slice(half);
          let rightIndex = 0;
          left.forEach((p) => {
            leftIndex = insertRow(table_left, leftIndex, p);
          });
          right.forEach((p) => {
            rightIndex = insertRow(table_right, rightIndex, p);
          });
        })
        .catch(console.log);
    </script>
  </body>
</html>
